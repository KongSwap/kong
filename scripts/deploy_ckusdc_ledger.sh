#!/usr/bin/env bash

if [ -z "$1" ]
	then
		NETWORK=""
	else
		NETWORK="--network $1"
fi
IDENTITY="--identity kong_token_minter"
CONTROLLER_PRINCIPAL_ID=$(dfx identity ${NETWORK} ${IDENTITY} get-principal)

TRIGGER_THRESHOLD=10_000
NUM_OF_BLOCK_TO_ARCHIVE=5_000
CYCLE_FOR_ARCHIVE_CREATION=5_000_000_000_000
ICRC2_FEATURE_FLAG=true

TOKEN_SYMBOL="ckUSDC"
TOKEN_LEDGER=$(echo ${TOKEN_SYMBOL}_ledger | tr '[:upper:]' '[:lower:]')
TOKEN_NAME="Chain-key USD Coin"
TOKEN_DECIMALS=6
TRANSFER_FEE=10_000
TOKEN_LOGO="data:image/png;base64,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"

dfx deploy ${NETWORK} ${IDENTITY} ${TOKEN_LEDGER} --argument "(variant {Init =
	record {
		token_symbol = \"${TOKEN_SYMBOL}\";
		token_name = \"${TOKEN_NAME}\";
		decimals = opt ${TOKEN_DECIMALS};
		minting_account = record { owner = principal \"${CONTROLLER_PRINCIPAL_ID}\" };
		transfer_fee = ${TRANSFER_FEE};
		initial_balances = vec {};
		metadata = vec { record { \"icrc1:logo\"; variant { Text = \"${TOKEN_LOGO}\" }; }; };
		feature_flags = opt record { icrc2 = ${ICRC2_FEATURE_FLAG} };
		archive_options = record {
			num_blocks_to_archive = ${NUM_OF_BLOCK_TO_ARCHIVE};
			trigger_threshold = ${TRIGGER_THRESHOLD};
			controller_id = principal \"${CONTROLLER_PRINCIPAL_ID}\";
			cycles_for_archive_creation = opt ${CYCLE_FOR_ARCHIVE_CREATION};
		};
	}
})"

dfx generate ${TOKEN_LEDGER}
